<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>关于 憨憨每日Todo桌面版</title>
    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #1d1f27, #282c34);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            height: 100vh;
            text-align: center;
            overflow: hidden;
        }

        body::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        h1 {
            margin: 0;
            font-size: 26px;
            color: #00ffcc;
        }

        p {
            margin: 8px 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .intro {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
            max-width: 350px;
        }

        .footer {
            margin-top: 20px;
            font-size: 12px;
            opacity: 0.6;
        }

        button {
            margin-top: 20px;
            padding: 6px 16px;
            background: #00ffcc;
            color: #000;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background: #00ccaa;
        }

        /* 新增版本更新提示框样式 */
        .update-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #282c34;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 350px;
            width: 80%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .modal-content h2 {
            color: #00ffcc;
            margin-top: 0;
        }

        .modal-buttons {
            margin-top: 20px;
        }

        .modal-buttons button {
            margin: 0 10px;
        }

        .update-btn {
            background: #00ffcc;
            color: #000;
        }

        .cancel-btn {
            background: #666;
            color: #fff;
        }

        .loading {
            color: #00ffcc;
            font-size: 14px;
        }

        /* 更新按钮样式 */
        .check-update-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-weight: normal;
            font-size: 12px;
            padding: 4px 12px;
            margin-top: 10px;
        }

        .check-update-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* 版本更新提示样式 */
        .version-update {
            color: #ff6b6b;
            font-size: 12px;
            margin-left: 8px;
            cursor: pointer;
            text-decoration: underline;
        }

        .version-update:hover {
            color: #ff4757;
        }
    </style>
</head>
<body>
<h1>憨憨每日Todo</h1>
<p id="versionText">版本: v1.0.0</p>
<p>作者: kingyifan</p>
<p>邮箱: kingyifan@88.com</p>

<div class="intro">
    <p><strong>为什么做这个软件？</strong></p>
    <p>
        在忙碌的生活和工作中，<br>
        我们常常会忘记一些重要的事情。<br></p>
    <p>
        我希望有一个简洁、安全、随时都能打开的工具，<br>
        来记录当天的待办事项，帮我专注和自律。<br>
    </p>
    <p>
        这就是「憨憨每日Todo」的初衷 ——<br>
        让待办清单变得简单、轻松、好用。<br>
    </p>
</div>

<div class="footer">© 2025 憨憨Todo. All rights reserved.</div>
<button onclick="window.close()">关闭</button>



<script>
    // 全局变量存储版本信息
    let versionsData = [];
    let currentVersion = "1.0.0";
    let userVersion = null;

    // 页面加载时读取版本信息
    window.addEventListener('DOMContentLoaded', function () {
        loadVersions();
    });

    // 读取版本信息
    function loadVersions() {
        fetch('./config/versions.txt')
            .then(response => response.text())
            .then(data => {
                // 解析版本数据
                versionsData = data.trim().split('\n').map(line => {
                    const [version, date, giteeUrl, githubUrl, updates] = line.split('|');
                    return {
                        version,
                        date,
                        giteeUrl,
                        githubUrl,
                        updates: updates.split(',')
                    };
                });

                // 获取最新版本信息
                if (versionsData.length > 0) {
                    currentVersion = versionsData[0].version;
                    // 获取用户当前版本
                    const urlParams = new URLSearchParams(window.location.search);
                    userVersion = urlParams.get('version') || currentVersion;

                    // 显示版本信息，加上 v 前缀
                    const versionElement = document.getElementById('versionText');
                    if (userVersion !== currentVersion) {
                        // 如果不是最新版本，显示更新提示
                        versionElement.innerHTML = '版本: v' + userVersion + '<span class="version-update" onclick="goToDownload()">有新版本更新</span>';
                    } else {
                        // 如果是最新版本，只显示版本号
                        versionElement.textContent = '版本: v' + userVersion;
                    }
                }

                // 检查是否需要更新
                checkForUpdates();
            })
            .catch(error => {
                console.error('读取版本信息失败:', error);
                // 使用默认版本检查逻辑
                checkForUpdates();
            });
    }

    // 检查是否需要更新
    function checkForUpdates() {
        // 获取用户当前版本
        const urlParams = new URLSearchParams(window.location.search);
        const passedVersion = urlParams.get('version');
        userVersion = passedVersion || "1.0.0";

        // 显示版本信息，加上 v 前缀
        const versionElement = document.getElementById('versionText');
        if (passedVersion !== currentVersion) {
            // 如果不是最新版本，显示更新提示
            versionElement.innerHTML = '当前版本: v' + passedVersion + '<span class="version-update" onclick="goToDownload()">有新版本更新</span>';
        } else {
            // 如果是最新版本，只显示版本号
            versionElement.textContent = '版本: v' + passedVersion;
        }

        // 如果传入的版本与当前版本不一致，则显示更新提示
        if (passedVersion && passedVersion !== currentVersion) {
            document.getElementById('updateModal').style.display = 'flex';
        }
    }

    // 跳转到下载页面，并携带当前版本参数
    function goToDownload() {
        // 获取当前URL中的版本参数
        const urlParams = new URLSearchParams(window.location.search);
        const passedVersion = urlParams.get('version') || currentVersion;
        window.location.href = "./html/download.html?version=" + encodeURIComponent(passedVersion);
    }


</script>
</body>
</html>
